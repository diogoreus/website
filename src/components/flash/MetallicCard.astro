---
/**
 * MetallicCard - Brushed metal texture with beveled edges, glossy reflections,
 * and skeuomorphic 3D perspective transforms. Inspired by Winamp skins and 2Advanced.
 */

interface Props {
  title: string;
  subtitle?: string;
  class?: string;
  variant?: 'default' | 'compact' | 'large';
}

const { title, subtitle, class: className = '', variant = 'default' } = Astro.props;
---

<div class={`metallic-card metallic-card--${variant} ${className}`}>
  <!-- Metallic frame with beveled edges -->
  <div class="card-frame">
    <!-- Top bevel -->
    <div class="bevel bevel-top"></div>
    <!-- Left bevel -->
    <div class="bevel bevel-left"></div>
    <!-- Right bevel -->
    <div class="bevel bevel-right"></div>
    <!-- Bottom bevel -->
    <div class="bevel bevel-bottom"></div>

    <!-- Inner content area -->
    <div class="card-inner">
      <!-- Brushed metal texture overlay -->
      <div class="metal-texture"></div>

      <!-- Glossy reflection -->
      <div class="card-shine"></div>

      <!-- Header with screws -->
      <div class="card-header">
        <div class="screw screw-left"></div>
        <div class="header-content">
          <h3 class="card-title">{title}</h3>
          {subtitle && <span class="card-subtitle">{subtitle}</span>}
        </div>
        <div class="screw screw-right"></div>
      </div>

      <!-- Content slot -->
      <div class="card-content">
        <slot />
      </div>

      <!-- Bottom status bar -->
      <div class="card-status">
        <div class="status-led"></div>
        <span class="status-text">READY</span>
      </div>
    </div>
  </div>

  <!-- Drop shadow -->
  <div class="card-shadow"></div>
</div>

<style>
  .metallic-card {
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .metallic-card:hover {
    transform: perspective(1000px) rotateX(5deg) rotateY(-3deg) translateZ(20px);
  }

  .metallic-card:hover .card-frame {
    box-shadow:
      inset 0 2px 0 rgba(255, 255, 255, 0.3),
      inset 0 -2px 0 rgba(0, 0, 0, 0.5),
      0 0 30px rgba(0, 255, 255, 0.2),
      0 0 60px rgba(255, 0, 255, 0.1),
      0 12px 40px rgba(0, 0, 0, 0.6);
  }

  /* Card frame with beveled edges */
  .card-frame {
    position: relative;
    background: linear-gradient(
      180deg,
      #6a6a7e 0%,
      #5a5a6a 5%,
      #4a4a5e 15%,
      #3d3d4d 30%,
      #2a2a38 50%,
      #1d1d28 70%,
      #151520 85%,
      #0a0a10 100%
    );
    border-radius: 12px;
    padding: 3px;
    box-shadow:
      inset 0 2px 0 rgba(255, 255, 255, 0.25),
      inset 0 -2px 0 rgba(0, 0, 0, 0.4),
      0 0 20px rgba(0, 255, 255, 0.1),
      0 8px 32px rgba(0, 0, 0, 0.5);
  }

  .card-frame::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 12px;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.1) 0%,
      transparent 30%,
      transparent 70%,
      rgba(0, 0, 0, 0.1) 100%
    );
    pointer-events: none;
  }

  /* Beveled edges */
  .bevel {
    position: absolute;
    pointer-events: none;
  }

  .bevel-top {
    top: 0;
    left: 8px;
    right: 8px;
    height: 4px;
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.4) 0%,
      rgba(255, 255, 255, 0.2) 50%,
      transparent 100%
    );
    border-radius: 12px 12px 0 0;
  }

  .bevel-bottom {
    bottom: 0;
    left: 8px;
    right: 8px;
    height: 4px;
    background: linear-gradient(
      0deg,
      rgba(0, 0, 0, 0.6) 0%,
      rgba(0, 0, 0, 0.3) 50%,
      transparent 100%
    );
    border-radius: 0 0 12px 12px;
  }

  .bevel-left {
    left: 0;
    top: 8px;
    bottom: 8px;
    width: 4px;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.15) 0%,
      rgba(255, 255, 255, 0.05) 50%,
      transparent 100%
    );
  }

  .bevel-right {
    right: 0;
    top: 8px;
    bottom: 8px;
    width: 4px;
    background: linear-gradient(
      -90deg,
      rgba(0, 0, 0, 0.5) 0%,
      rgba(0, 0, 0, 0.2) 50%,
      transparent 100%
    );
  }

  /* Inner content area */
  .card-inner {
    position: relative;
    background: linear-gradient(
      135deg,
      #2d1b4e 0%,
      #1a0a2e 50%,
      #0d0518 100%
    );
    border-radius: 9px;
    padding: 1.5rem;
    overflow: hidden;
  }

  /* Brushed metal texture */
  .metal-texture {
    position: absolute;
    inset: 0;
    background-image:
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 1px,
        rgba(255, 255, 255, 0.03) 1px,
        rgba(255, 255, 255, 0.03) 2px
      ),
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 30px,
        rgba(255, 255, 255, 0.01) 30px,
        rgba(255, 255, 255, 0.01) 31px
      );
    pointer-events: none;
  }

  /* Additional chrome edge highlight */
  .metal-texture::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 9px;
    border: 1px solid transparent;
    background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.15) 0%,
      transparent 50%,
      rgba(0, 255, 255, 0.05) 100%
    ) border-box;
    -webkit-mask:
      linear-gradient(#fff 0 0) padding-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  /* Glossy shine reflection */
  .card-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      105deg,
      transparent 35%,
      rgba(255, 255, 255, 0.1) 40%,
      rgba(255, 255, 255, 0.25) 45%,
      rgba(255, 255, 255, 0.3) 50%,
      rgba(255, 255, 255, 0.25) 55%,
      rgba(255, 255, 255, 0.1) 60%,
      transparent 65%
    );
    transition: left 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    pointer-events: none;
  }

  .metallic-card:hover .card-shine {
    left: 100%;
  }

  /* Static top gloss */
  .card-inner::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 40%;
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.08) 0%,
      rgba(255, 255, 255, 0.03) 30%,
      transparent 100%
    );
    border-radius: 9px 9px 0 0;
    pointer-events: none;
  }

  /* Header with decorative screws */
  .card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid rgba(0, 255, 255, 0.2);
  }

  .screw {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: radial-gradient(
      circle at 30% 30%,
      #5a5a6e 0%,
      #3a3a48 50%,
      #2a2a38 100%
    );
    box-shadow:
      inset 0 1px 2px rgba(255, 255, 255, 0.2),
      inset 0 -1px 2px rgba(0, 0, 0, 0.3),
      0 1px 2px rgba(0, 0, 0, 0.3);
    position: relative;
    flex-shrink: 0;
  }

  .screw::before,
  .screw::after {
    content: '';
    position: absolute;
    background: rgba(0, 0, 0, 0.4);
  }

  .screw::before {
    width: 8px;
    height: 2px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .screw::after {
    width: 2px;
    height: 8px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .header-content {
    flex: 1;
  }

  .card-title {
    font-family: 'Inter', Arial, sans-serif;
    font-size: 1.1rem;
    font-weight: 700;
    color: #ffffff;
    margin: 0;
    text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    letter-spacing: 0.05em;
  }

  .card-subtitle {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    color: #00ffff;
    display: block;
    margin-top: 0.25rem;
    text-shadow: 0 0 8px rgba(0, 255, 255, 0.3);
  }

  /* Content area */
  .card-content {
    position: relative;
    z-index: 1;
    color: #b8a8d4;
    font-family: Verdana, sans-serif;
    font-size: 0.875rem;
    line-height: 1.6;
  }

  /* Status bar */
  .card-status {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid rgba(0, 255, 255, 0.15);
  }

  .status-led {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #00ff00;
    box-shadow:
      0 0 8px #00ff00,
      inset 0 0 4px rgba(255, 255, 255, 0.5);
    animation: led-blink 2s ease-in-out infinite;
  }

  @keyframes led-blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .status-text {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.65rem;
    color: #00ff00;
    letter-spacing: 0.15em;
    text-shadow: 0 0 8px rgba(0, 255, 0, 0.5);
  }

  /* Drop shadow */
  .card-shadow {
    position: absolute;
    bottom: -20px;
    left: 10%;
    right: 10%;
    height: 20px;
    background: radial-gradient(
      ellipse at center,
      rgba(0, 0, 0, 0.4) 0%,
      transparent 70%
    );
    filter: blur(10px);
    transform: scaleY(0.3);
    z-index: -1;
    transition: all 0.4s ease;
  }

  .metallic-card:hover .card-shadow {
    bottom: -30px;
    filter: blur(15px);
    opacity: 0.8;
  }

  /* Variant: compact */
  .metallic-card--compact .card-inner {
    padding: 1rem;
  }

  .metallic-card--compact .card-header {
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
  }

  .metallic-card--compact .card-title {
    font-size: 0.95rem;
  }

  .metallic-card--compact .screw {
    width: 10px;
    height: 10px;
  }

  /* Variant: large */
  .metallic-card--large .card-inner {
    padding: 2rem;
  }

  .metallic-card--large .card-title {
    font-size: 1.35rem;
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .metallic-card:hover {
      transform: perspective(1000px) rotateX(2deg) rotateY(-1deg) translateZ(10px);
    }

    .card-inner {
      padding: 1rem;
    }

    .card-title {
      font-size: 1rem;
    }

    .screw {
      width: 10px;
      height: 10px;
    }
  }
</style>

---
/**
 * GlassOrb - Frutiger Aero inspired 3D translucent sphere
 * Features refraction highlights, glossy reflections, and that classic
 * Windows Vista/early iOS aesthetic.
 */

interface Props {
  size?: 'sm' | 'md' | 'lg';
  color?: 'cyan' | 'magenta' | 'blue' | 'green';
  class?: string;
  animated?: boolean;
}

const {
  size = 'md',
  color = 'cyan',
  class: className = '',
  animated = true
} = Astro.props;

const sizeMap = {
  sm: '60px',
  md: '100px',
  lg: '150px'
};

const colorMap = {
  cyan: {
    primary: 'rgba(0, 255, 255, 0.3)',
    secondary: 'rgba(0, 200, 255, 0.4)',
    glow: 'rgba(0, 255, 255, 0.5)'
  },
  magenta: {
    primary: 'rgba(255, 0, 255, 0.3)',
    secondary: 'rgba(200, 0, 255, 0.4)',
    glow: 'rgba(255, 0, 255, 0.5)'
  },
  blue: {
    primary: 'rgba(0, 100, 255, 0.3)',
    secondary: 'rgba(0, 150, 255, 0.4)',
    glow: 'rgba(0, 150, 255, 0.5)'
  },
  green: {
    primary: 'rgba(0, 255, 100, 0.3)',
    secondary: 'rgba(0, 255, 150, 0.4)',
    glow: 'rgba(0, 255, 100, 0.5)'
  }
};

const colors = colorMap[color];
const orbSize = sizeMap[size];
---

<div
  class={`glass-orb glass-orb--${size} ${animated ? 'glass-orb--animated' : ''} ${className}`}
  style={`--orb-size: ${orbSize}; --color-primary: ${colors.primary}; --color-secondary: ${colors.secondary}; --color-glow: ${colors.glow};`}
>
  <!-- Main orb body -->
  <div class="orb-body">
    <!-- Inner glow -->
    <div class="orb-inner-glow"></div>

    <!-- Refraction effect -->
    <div class="orb-refraction"></div>

    <!-- Top highlight (main glossy reflection) -->
    <div class="orb-highlight-top"></div>

    <!-- Secondary highlight -->
    <div class="orb-highlight-secondary"></div>

    <!-- Bottom reflection -->
    <div class="orb-highlight-bottom"></div>

    <!-- Edge glow -->
    <div class="orb-edge-glow"></div>
  </div>

  <!-- Shadow -->
  <div class="orb-shadow"></div>
</div>

<style>
  .glass-orb {
    position: relative;
    width: var(--orb-size);
    height: var(--orb-size);
    display: inline-block;
  }

  .glass-orb--animated {
    animation: orb-float 4s ease-in-out infinite;
  }

  @keyframes orb-float {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  .orb-body {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: radial-gradient(
      ellipse at 30% 30%,
      rgba(255, 255, 255, 0.4) 0%,
      var(--color-primary) 20%,
      var(--color-secondary) 60%,
      rgba(0, 0, 0, 0.2) 100%
    );
    box-shadow:
      inset 0 0 30px rgba(255, 255, 255, 0.3),
      inset 0 0 60px var(--color-primary),
      0 0 20px var(--color-glow);
    overflow: hidden;
  }

  /* Inner glow effect */
  .orb-inner-glow {
    position: absolute;
    inset: 10%;
    border-radius: 50%;
    background: radial-gradient(
      ellipse at center,
      var(--color-primary) 0%,
      transparent 70%
    );
    filter: blur(5px);
  }

  /* Refraction effect - simulates light bending inside */
  .orb-refraction {
    position: absolute;
    bottom: 15%;
    left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 30%;
    background: radial-gradient(
      ellipse at center,
      rgba(255, 255, 255, 0.15) 0%,
      transparent 70%
    );
    border-radius: 50%;
    filter: blur(3px);
  }

  /* Main top highlight - glossy reflection */
  .orb-highlight-top {
    position: absolute;
    top: 8%;
    left: 15%;
    width: 50%;
    height: 35%;
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 0.9) 0%,
      rgba(255, 255, 255, 0.6) 30%,
      rgba(255, 255, 255, 0.2) 60%,
      transparent 100%
    );
    border-radius: 50%;
    transform: rotate(-15deg);
    filter: blur(1px);
  }

  /* Secondary smaller highlight */
  .orb-highlight-secondary {
    position: absolute;
    top: 25%;
    right: 20%;
    width: 15%;
    height: 10%;
    background: rgba(255, 255, 255, 0.6);
    border-radius: 50%;
    filter: blur(2px);
  }

  /* Bottom reflection */
  .orb-highlight-bottom {
    position: absolute;
    bottom: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: 40%;
    height: 15%;
    background: linear-gradient(
      0deg,
      rgba(255, 255, 255, 0.1) 0%,
      transparent 100%
    );
    border-radius: 50%;
    filter: blur(2px);
  }

  /* Edge glow */
  .orb-edge-glow {
    position: absolute;
    inset: -2px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.3);
    background: transparent;
    box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.1);
  }

  /* Shadow beneath orb */
  .orb-shadow {
    position: absolute;
    bottom: -15%;
    left: 10%;
    right: 10%;
    height: 20%;
    background: radial-gradient(
      ellipse at center,
      rgba(0, 0, 0, 0.4) 0%,
      transparent 70%
    );
    filter: blur(8px);
    transform: scaleY(0.3);
  }

  /* Size variations */
  .glass-orb--sm .orb-highlight-top {
    filter: blur(0.5px);
  }

  .glass-orb--lg .orb-body {
    box-shadow:
      inset 0 0 50px rgba(255, 255, 255, 0.3),
      inset 0 0 100px var(--color-primary),
      0 0 40px var(--color-glow);
  }

  /* Hover effect */
  .glass-orb:hover .orb-body {
    box-shadow:
      inset 0 0 40px rgba(255, 255, 255, 0.4),
      inset 0 0 80px var(--color-primary),
      0 0 30px var(--color-glow);
  }

  .glass-orb:hover .orb-highlight-top {
    background: linear-gradient(
      180deg,
      rgba(255, 255, 255, 1) 0%,
      rgba(255, 255, 255, 0.7) 30%,
      rgba(255, 255, 255, 0.3) 60%,
      transparent 100%
    );
  }
</style>
